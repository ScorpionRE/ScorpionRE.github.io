<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Scorpion</title><meta name="author" content="Scorpion"><meta name="copyright" content="Scorpion"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta property="og:type" content="website">
<meta property="og:title" content="Scorpion">
<meta property="og:url" content="https://scorpionre.github.io/index.html">
<meta property="og:site_name" content="Scorpion">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://scorpionre.github.io/image/avatar.jpg">
<meta property="article:author" content="Scorpion">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://scorpionre.github.io/image/avatar.jpg"><link rel="shortcut icon" href="/image/heady.png"><link rel="canonical" href="https://scorpionre.github.io/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="H0hDtDBZ67BX_FfydlV2J3cLTsK0y9eBTsXZM5CoiII"/><meta name="baidu-site-verification" content="code-SUgnFP7saT"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: {"limitCount":50,"languages":{"author":"Author: Scorpion","link":"Link: ","source":"Source: Scorpion","info":"Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source."}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Scorpion',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2023-03-13 19:28:31'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.1"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/image/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">16</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">10</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">10</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('/image/back.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Scorpion</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">Scorpion</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="https://github.com/ScorpionRE" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:sc0rp10nbelle11@gmail.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left"><a href="/2023/02/28/KPA-COA/" title="8-rotor的已知明文攻击以及唯密文攻击"><img class="post_bg" src="/image/star.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="8-rotor的已知明文攻击以及唯密文攻击"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/02/28/KPA-COA/" title="8-rotor的已知明文攻击以及唯密文攻击">8-rotor的已知明文攻击以及唯密文攻击</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2023-02-28T10:00:00.000Z" title="Created 2023-02-28 18:00:00">2023-02-28</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/crypto/">crypto</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/crypto/">crypto</a></span></div><div class="content">KPA/COA
8 rotor machine
密码算法：
p=plain,c=cipher,f=offsetenc:c=e[p+f] mod 96dec:p+f=d[c] mod 96其中数组e[]和d[]分别为用于加密和解密的数组p = plain, c = cipher, f = offset
\\ enc: c = e[p+f] \ mod \ 96
\\ dec: p+f = d[c] \  mod \  96
\\ 其中数组e[]和d[]分别为用于加密和解密的数组
p=plain,c=cipher,f=offsetenc:c=e[p+f] mod 96dec:p+f=d[c] mod 96其中数组e[]和d[]分别为用于加密和解密的数组
KPA（known plaintext attack）
已知明文攻击定义：已知部分明文和对应的密文，从而破解出对应的密钥和加密算法。
但是这里已知加解密算法以及一定包含正确密钥的字典。因此只需要依次尝试密钥然后判断是否正确即可。
用Java实现如下：

定义一个public static void kpa(String plain, Str ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/11/11/mirai/" title="Mirai源码分析与样本分析"><img class="post_bg" src="https://scorpionre.github.io/2022/11/11/mirai/mirai.assets/image-20230312203320286.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Mirai源码分析与样本分析"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/11/11/mirai/" title="Mirai源码分析与样本分析">Mirai源码分析与样本分析</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2022-11-11T10:00:00.000Z" title="Created 2022-11-11 18:00:00">2022-11-11</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/malware/">malware</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/malware/">malware</a></span></div><div class="content">Mirai源码分析
大概看了下整体结构和流程，然后细看了一下加解密部分。
代码结构：
123456loader/src   将payload上传到受感染的设备mirai/bot    在受感染设备上运行的恶意payloadmirai/cnc    恶意者进行控制和管理的接口mirai/tools  提供的一些工具其中，cnc部分是Go语言编写的，余下都是C语言
整体网络拓扑关系如下图所示，受感染的设备扫描其他可能受感染的设备，扫描到之后就讲设备信息等提供给loader，loader将payload下载到可能受感染的设备上，比如宏病毒，js下载者等。被感染的设备与c2服务器连接，并向特定受害者发起ddos攻击。

loader
主要功能是向感染设备上传（wget、tftp、echo方式）对应架构的payload文件
目录结构
1234567headers/       头文件目录binary.c       将bins目录下的文件读取到内存中，以echo方式上传payload文件时用到connection.c   判断loader和感染设备telnet交互过程中的状态信息main.c   ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2022/10/28/crypto-md5/" title="crypto++库交叉编译与MD5编译优化分析"><img class="post_bg" src="/image/star.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="crypto++库交叉编译与MD5编译优化分析"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/10/28/crypto-md5/" title="crypto++库交叉编译与MD5编译优化分析">crypto++库交叉编译与MD5编译优化分析</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2022-10-28T12:00:00.000Z" title="Created 2022-10-28 20:00:00">2022-10-28</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/crypto/">crypto</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/crypto/">crypto</a></span></div><div class="content">交叉编译
环境
Ubuntu 20
crypto++ 8.8
g+±arm-linux-gnueabi 9 (.4.0
安装依赖
交叉编译工具链
12sudo apt updatesudo apt-get install g++-arm-linux-gnueabi gcc-arm-linux-gnueabi
密码库
1git clone &lt;https://github.com/weidai11/cryptopp.git&gt;
设定环境
编辑TestScripts中的setenv-embedded.sh
1ARM_EMBEDDED_CXXFLAGS=&quot;-|/usr/arm-linux-gnueabi/include/c++/9 -|/usr/arm-linux-gnueabi/include/c++/9/arm-linux-gnueabi&quot;
主要需要改版本，根据路径查看

编译
123sudo make -f GNUmakefile-crosssudo make -f GNUmakefile-cross static static dynamic crypte ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/09/24/MC/" title="野人与传教士"><img class="post_bg" src="/image/star.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="野人与传教士"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/09/24/MC/" title="野人与传教士">野人与传教士</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2022-09-24T12:00:00.000Z" title="Created 2022-09-24 20:00:00">2022-09-24</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/algorithm/">algorithm</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/algorithm/">algorithm</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/AI/">AI</a></span></div><div class="content">野人与传教士
用遍历方法寻找所有可能路径，因此用DFS比较合适，因此BFS虽然能找到目标状态，但是要找到目标状态的前一路径比较困难）
设定状态表示，虽然可以直接用（M，C，b）三元组分别表示左岸传教士，野人数量以及船是否在左岸。实现时为了方便还是定义一个class类state分别表示
1234567class State:    def __init__(self,lm,rm,lc,rc,ship):        self.lm = lm        self.rm = rm        self.lc = lc        self.rc = rc        self.ship = ship
因此初始状态init为
1init = State(M,0,C,0,1)
定义一个函数判断是否为目标状态
12345def is_goal(state):        if state.lm == 0 and state.lc == 0 and state.rm == M and state.rc == C:        return 1    return 0
能实施的操作用o ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2022/02/24/lfsr/" title="LFSR"><img class="post_bg" src="https://scorpionre.github.io/2022/02/24/lfsr/lfsr.assets/image-20220224160744696.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="LFSR"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/02/24/lfsr/" title="LFSR">LFSR</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2022-02-24T10:00:00.000Z" title="Created 2022-02-24 18:00:00">2022-02-24</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/CryptoDetect/">CryptoDetect</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/CryptoDetect/algorithm/">algorithm</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/crypto/">crypto</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/algorithm/">algorithm</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/CryptoDetect/">CryptoDetect</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/reverse/">reverse</a></span></div><div class="content">lfsr
算法
假设R为一个（N）LFSR，对于每一轮，使用反馈函数L从R中的比特位（子集）生成一个新的比特位。如果L是线性的，例如异或，我们把R称为一个LFSR。反之，如果L是非线性的，R就是一个NLFSR。寄存器R中的所有位都向左移动一个位置，忽略最高位，新产生的位被放在最低位且被输出。
所以
对每轮i∈[0, 1, ..., n]Ri+1=(Ri&lt;&lt;1) xor L(Ri)outputi=(Ri)对每轮i\in[0,\ 1,\ ...,\ n ]
\\ R_{i+1} = (R_i &lt;&lt; 1)\ xor\ L(R_i)
\\ output_i = (R_i)
对每轮i∈[0, 1, ..., n]Ri+1​=(Ri​&lt;&lt;1) xor L(Ri​)outputi​=(Ri​)

signature

TRANSIENT用于表示从表达式生成的DFG节点不是很重要，图清除过程中可以简化。
OPAQUE中 o1为clamp-label（可选）：为节点类型命名。与任何其他类型的节点进行比较都为真，并增加了所有带有相同类型标签的 opaque 必须映射到相 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/02/23/sha1/" title="SHA1"><img class="post_bg" src="/image/star.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SHA1"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/02/23/sha1/" title="SHA1">SHA1</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2022-02-23T12:00:00.000Z" title="Created 2022-02-23 20:00:00">2022-02-23</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/CryptoDetect/">CryptoDetect</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/CryptoDetect/algorithm/">algorithm</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/algorithm/">algorithm</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/CryptoDetect/">CryptoDetect</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/reverse/">reverse</a></span></div><div class="content">sha1
与md5类似，差异用标注
算法

输入：任意长的消息，512 比特长的分组。原始报文长度不能超过2的64次方
输出：160 比特的消息摘要

整体流程如下：

首先填充原始消息使得对512求余的结果等于448，然后64位记录其长度。
512bit一组分为n组。每组中32bit为一段，分为16段
将上述16段扩充到80段
对每一组，循环4轮运算，得到新的A,B,C,D,E作为下一组的初始值
最后得到的A,B,C,D,E加上第n组原来A,B,C,D,E的值（即计算前的值）
按照地址的顺序从低到高打印对应的A,B,C,D,E值，就是所求的sha1值。

填充
如果输入信息的长度(bit)对512求余的结果不等于448，就需要填充使得对512求余的结果等于448。填充的方法是填充一个1和n个0。填充完后，信息的长度就为N*512+448(bit)。
然后用64位来存储填充前信息长度。这64位加在第一步结果的后面，这样信息长度就变为N*512+448+64=(N+1)*512位
比如，需要加密消息&quot;gnubd&quot;，最后被填充为
小端字节序存储
123467 6E 75 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2022/02/22/dfg/" title="[论文笔记-asiaccs2015]DFG"><img class="post_bg" src="https://scorpionre.github.io/2022/02/22/dfg/dfg.assets/image-20220218195458486.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="[论文笔记-asiaccs2015]DFG"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/02/22/dfg/" title="[论文笔记-asiaccs2015]DFG">[论文笔记-asiaccs2015]DFG</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2022-02-22T12:58:00.000Z" title="Created 2022-02-22 20:58:00">2022-02-22</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/CryptoDetect/">CryptoDetect</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/CryptoDetect/paper/">paper</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/crypto/">crypto</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/CryptoDetect/">CryptoDetect</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/reverse/">reverse</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/paper/">paper</a></span></div><div class="content">DFG论文

Lestringant,P., Guihéry,F. and Fouque,P… Automated identification of cryptographic primitives in binary code with data flow graph isomorphism. (2015)In Proceedings of the 10th ACM Symposium on Information, Computer and Communications Security, pages 203–214.
背景
软件用密码算法保护通信安全性以及数据安全。但算法的选择，具体实现方法，输入参数的生成对数据安全性有巨大影响。所以分析有密码的二进制文件安全性时，需要确保没有上述几点影响系统安全。所以首先需要识别并定位密码算法。但分析是耗时费力的，所以需要自动化工具
现有方法：

静态分析主要根据常量或I/O关系，大多利用统计特性，可能不准确
动态分析性能不太好

缺陷：

手动构建签名的准确性
依赖启发式代码片段选择
仅限于已知密码原语
constant state

特色 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/01/28/md5/" title="MD5"><img class="post_bg" src="https://scorpionre.github.io/2022/01/28/md5/md5.assets/image-20220127171124399.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MD5"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/01/28/md5/" title="MD5">MD5</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2022-01-28T04:51:00.000Z" title="Created 2022-01-28 12:51:00">2022-01-28</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/CryptoDetect/">CryptoDetect</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/CryptoDetect/algorithm/">algorithm</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/algorithm/">algorithm</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/CryptoDetect/">CryptoDetect</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/reverse/">reverse</a></span></div><div class="content">MD5
算法

输入：任意长的消息，512 比特长的分组。
输出：128 比特的消息摘要

整体流程如下：


首先填充原始消息使得对512求余的结果等于448，然后64位记录其长度。


512bit一组分为n组。每组中32bit为一段，分为16段


对每一组，循环4次下述4轮运算，得到新的A,B,C,D作为下一组的初始值


最后得到的A,B,C,D加上第n组原来A,B,C,D的值（即计算前的值）


按照地址的顺序从低到高打印对应的A,B,C,D值，就是所求的MD5值。



填充
如果输入信息的长度(bit)对512求余的结果不等于448，就需要填充使得对512求余的结果等于448。填充的方法是填充一个1和n个0。填充完后，信息的长度就为N*512+448(bit)。
然后用64位来存储填充前信息长度。这64位加在第一步结果的后面，这样信息长度就变为N*512+448+64=(N+1)*512位
比如，需要加密消息&quot;gnubd&quot;，最后被填充为
小端字节序存储
123467 6E 75 62 64 80 00 00 00 00 00 00 00 00 00  ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2022/01/24/ichunqiu-crypto-writeup/" title="[ichunqiu-crypto]writeup【loading】"><img class="post_bg" src="/image/star.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="[ichunqiu-crypto]writeup【loading】"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/01/24/ichunqiu-crypto-writeup/" title="[ichunqiu-crypto]writeup【loading】">[ichunqiu-crypto]writeup【loading】</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2022-01-24T10:00:00.000Z" title="Created 2022-01-24 18:00:00">2022-01-24</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/crypto/">crypto</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/crypto/ctf/">ctf</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/crypto/">crypto</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/ctf/">ctf</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/writeup/">writeup</a></span></div><div class="content">[ichunqiu-crypto]writeup
[phrackCTF]BrokenPic
题面：这里有个图片，可是好像打不开？
给出一个bmp图片
RSA
[IceCTF]Round Rabins【Cipolla】
发现n能开平方，提示rabin，e应为2，所以转化为下式求m的值
c=m2(mod p2)c = m^2 (mod\ p^2)
c=m2(mod p2)
先利用Cipolla算法求得r，使得（本题中k为2）
a=r2(mod p)所以(r2−a)k=0(mod pk)二项式分解(r2−a)k=t2−u2a=0(mod pk)t2u−2=a=x2(mod pk)所以x=t∗u−1(modpk)即最后所求ma = r^2 (mod\ p)
\\所以 (r^2-a)^k = 0 (mod\ p^k)
\\二项式分解 (r^2-a)^k=t^2-u^2a=0(mod\ p^k)
\\t^2u^{-2} = a = x^2(mod\ p^k)
\\所以 x = t*u^{-1} (mod p^k)
\\即最后所求m
a=r2(mod p)所以(r2−a)k=0(mod pk)二项式 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/01/24/BUUCTF-crypto-writeup-md/" title="[BUUCTF-crypto]writeup【loading】"><img class="post_bg" src="/image/star.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="[BUUCTF-crypto]writeup【loading】"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/01/24/BUUCTF-crypto-writeup-md/" title="[BUUCTF-crypto]writeup【loading】">[BUUCTF-crypto]writeup【loading】</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2022-01-24T05:32:00.000Z" title="Created 2022-01-24 13:32:00">2022-01-24</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/crypto/">crypto</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/crypto/ctf/">ctf</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/crypto/">crypto</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/ctf/">ctf</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/writeup/">writeup</a></span></div><div class="content">[BUUCTF-crypto]writeup
数学
[WUSTCTF2020]大数计算

Note：理解问题，题目说要十六进制，前8位不知道是取十进制的前八位然后转换还是取十六进制的前八位，所以（错误就得多试试
1234567a = math.factorial(2020)print(a)print(hex(int(str(a)[:8])))x = pow(520,1314) + pow(2333,666)print(x)print(hex(int(str(x)[:8])))
宇宙终极问题：x³＋y³＋z³＝42
(-80538738812075974)³ + 80435758145817515³ + 12602123297335631³ = 42
part-4，简单的积分，计算面积即可，再加36得520
编码
鸡藤椒盐味  【汉明码】
设将要进行检测的二进制代码为n位，为使其具有纠错能力，需要再加上k位的检测位，组成n+k位的代码。那么，新增加的检测位数k应满足：
2k≥n+k+1或2k-1≥n+k

古典
[INSHack2018]Crypt0r part 1【tcp流+简单替换】 ...</div></div></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/#content-inner">2</a><a class="extend next" rel="next" href="/page/2/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/image/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Scorpion</div><div class="author-info__description"></div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">16</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">10</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">10</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/ScorpionRE"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/ScorpionRE" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:sc0rp10nbelle11@gmail.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/02/28/KPA-COA/" title="8-rotor的已知明文攻击以及唯密文攻击"><img src="/image/star.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="8-rotor的已知明文攻击以及唯密文攻击"/></a><div class="content"><a class="title" href="/2023/02/28/KPA-COA/" title="8-rotor的已知明文攻击以及唯密文攻击">8-rotor的已知明文攻击以及唯密文攻击</a><time datetime="2023-02-28T10:00:00.000Z" title="Created 2023-02-28 18:00:00">2023-02-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/11/11/mirai/" title="Mirai源码分析与样本分析"><img src="https://scorpionre.github.io/2022/11/11/mirai/mirai.assets/image-20230312203320286.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Mirai源码分析与样本分析"/></a><div class="content"><a class="title" href="/2022/11/11/mirai/" title="Mirai源码分析与样本分析">Mirai源码分析与样本分析</a><time datetime="2022-11-11T10:00:00.000Z" title="Created 2022-11-11 18:00:00">2022-11-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/10/28/crypto-md5/" title="crypto++库交叉编译与MD5编译优化分析"><img src="/image/star.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="crypto++库交叉编译与MD5编译优化分析"/></a><div class="content"><a class="title" href="/2022/10/28/crypto-md5/" title="crypto++库交叉编译与MD5编译优化分析">crypto++库交叉编译与MD5编译优化分析</a><time datetime="2022-10-28T12:00:00.000Z" title="Created 2022-10-28 20:00:00">2022-10-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/09/24/MC/" title="野人与传教士"><img src="/image/star.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="野人与传教士"/></a><div class="content"><a class="title" href="/2022/09/24/MC/" title="野人与传教士">野人与传教士</a><time datetime="2022-09-24T12:00:00.000Z" title="Created 2022-09-24 20:00:00">2022-09-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/02/24/lfsr/" title="LFSR"><img src="https://scorpionre.github.io/2022/02/24/lfsr/lfsr.assets/image-20220224160744696.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="LFSR"/></a><div class="content"><a class="title" href="/2022/02/24/lfsr/" title="LFSR">LFSR</a><time datetime="2022-02-24T10:00:00.000Z" title="Created 2022-02-24 18:00:00">2022-02-24</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>Categories</span>
            <a class="card-more-btn" href="/categories/" title="More">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/CryptoDetect/"><span class="card-category-list-name">CryptoDetect</span><span class="card-category-list-count">8</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/CryptoDetect/algorithm/"><span class="card-category-list-name">algorithm</span><span class="card-category-list-count">5</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/CryptoDetect/paper/"><span class="card-category-list-name">paper</span><span class="card-category-list-count">3</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/algorithm/"><span class="card-category-list-name">algorithm</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/crypto/"><span class="card-category-list-name">crypto</span><span class="card-category-list-count">4</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/crypto/ctf/"><span class="card-category-list-name">ctf</span><span class="card-category-list-count">2</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/malware/"><span class="card-category-list-name">malware</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/program-synthesis/"><span class="card-category-list-name">program synthesis</span><span class="card-category-list-count">1</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>Tags</span></div><div class="card-tag-cloud"><a href="/tags/crypto/" style="font-size: 1.45em; color: rgb(193, 171, 167)">crypto</a><a href="/tags/algorithm/" style="font-size: 1.3em; color: rgb(4, 189, 46)">algorithm</a><a href="/tags/CryptoDetect/" style="font-size: 1.4em; color: rgb(146, 178, 175)">CryptoDetect</a><a href="/tags/ctf/" style="font-size: 1.2em; color: rgb(57, 23, 147)">ctf</a><a href="/tags/writeup/" style="font-size: 1.2em; color: rgb(132, 123, 177)">writeup</a><a href="/tags/reverse/" style="font-size: 1.35em; color: rgb(167, 160, 200)">reverse</a><a href="/tags/paper/" style="font-size: 1.25em; color: rgb(65, 28, 52)">paper</a><a href="/tags/program-synthesis/" style="font-size: 1.15em; color: rgb(105, 99, 36)">program synthesis</a><a href="/tags/malware/" style="font-size: 1.15em; color: rgb(57, 175, 55)">malware</a><a href="/tags/AI/" style="font-size: 1.15em; color: rgb(108, 29, 111)">AI</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>Archives</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/02/"><span class="card-archive-list-date">February 2023</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/11/"><span class="card-archive-list-date">November 2022</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/10/"><span class="card-archive-list-date">October 2022</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/09/"><span class="card-archive-list-date">September 2022</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/02/"><span class="card-archive-list-date">February 2022</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/01/"><span class="card-archive-list-date">January 2022</span><span class="card-archive-list-count">5</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/12/"><span class="card-archive-list-date">December 2021</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/06/"><span class="card-archive-list-date">June 2021</span><span class="card-archive-list-count">2</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>Info</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">Article :</div><div class="item-count">16</div></div><div class="webinfo-item"><div class="item-name">Run time :</div><div class="item-count" id="runtimeshow" data-publishDate="2022-01-23T09:03:00.000Z"></div></div><div class="webinfo-item"><div class="item-name">Total Count :</div><div class="item-count">35.5k</div></div><div class="webinfo-item"><div class="item-name">UV :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">PV :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">Last Push :</div><div class="item-count" id="last-push-date" data-lastPushDate="2023-03-13T11:28:31.571Z"></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/image/back.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By Scorpion</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="translateLink" type="button" title="Switch Between Traditional Chinese And Simplified Chinese">简</button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Local search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function subtitleType () {
  if (true) { 
    window.typed = new Typed("#subtitle", {
      strings: ["Just do it!"],
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50
    })
  } else {
    document.getElementById("subtitle").innerHTML = 'Just do it!'
  }
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js').then(subtitleType)
  }
} else {
  subtitleType()
}</script><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>