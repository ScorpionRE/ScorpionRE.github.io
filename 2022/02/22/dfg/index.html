<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>[论文笔记-asiaccs2015]DFG | Scorpion</title><meta name="keywords" content="crypto,CryptoDetect,reverse,paper"><meta name="author" content="Scorpion"><meta name="copyright" content="Scorpion"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="DFG论文  Lestringant,P., Guihéry,F. and Fouque,P… Automated identification of cryptographic primitives in binary code with data flow graph isomorphism. (2015)In Proceedings of the 10th ACM Symposium on">
<meta property="og:type" content="article">
<meta property="og:title" content="[论文笔记-asiaccs2015]DFG">
<meta property="og:url" content="https://scorpionre.github.io/2022/02/22/dfg/index.html">
<meta property="og:site_name" content="Scorpion">
<meta property="og:description" content="DFG论文  Lestringant,P., Guihéry,F. and Fouque,P… Automated identification of cryptographic primitives in binary code with data flow graph isomorphism. (2015)In Proceedings of the 10th ACM Symposium on">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://scorpionre.github.io/2022/02/22/dfg/dfg.assets/image-20220218195458486.png">
<meta property="article:published_time" content="2022-02-22T12:58:00.000Z">
<meta property="article:modified_time" content="2022-02-22T21:10:00.000Z">
<meta property="article:author" content="Scorpion">
<meta property="article:tag" content="crypto">
<meta property="article:tag" content="CryptoDetect">
<meta property="article:tag" content="reverse">
<meta property="article:tag" content="paper">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://scorpionre.github.io/2022/02/22/dfg/dfg.assets/image-20220218195458486.png"><link rel="shortcut icon" href="/image/heady.png"><link rel="canonical" href="https://scorpionre.github.io/2022/02/22/dfg/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="H0hDtDBZ67BX_FfydlV2J3cLTsK0y9eBTsXZM5CoiII"/><meta name="baidu-site-verification" content="code-SUgnFP7saT"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: {"limitCount":50,"languages":{"author":"Author: Scorpion","link":"Link: ","source":"Source: Scorpion","info":"Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source."}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '[论文笔记-asiaccs2015]DFG',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-02-23 05:10:00'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.1"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/image/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">16</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">10</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">10</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://scorpionre.github.io/2022/02/22/dfg/dfg.assets/image-20220218195458486.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Scorpion</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">[论文笔记-asiaccs2015]DFG</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2022-02-22T12:58:00.000Z" title="Created 2022-02-22 20:58:00">2022-02-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2022-02-22T21:10:00.000Z" title="Updated 2022-02-23 05:10:00">2022-02-23</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CryptoDetect/">CryptoDetect</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CryptoDetect/paper/">paper</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">3.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>11min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="[论文笔记-asiaccs2015]DFG"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1>DFG论文</h1>
<p><img src="dfg.assets/image-20220218195458486.png" alt="image-20220218195458486"></p>
<p>Lestringant,P., Guihéry,F. and Fouque,P… Automated identification of cryptographic primitives in binary code with data flow graph isomorphism. (2015)In Proceedings of the 10th ACM Symposium on Information, Computer and Communications Security, pages 203–214.</p>
<h2 id="背景">背景</h2>
<p>软件用密码算法保护通信安全性以及数据安全。但算法的选择，具体实现方法，输入参数的生成对数据安全性有巨大影响。所以分析有密码的二进制文件安全性时，需要确保没有上述几点影响系统安全。所以首先需要识别并定位密码算法。但分析是耗时费力的，所以需要自动化工具</p>
<p><strong>现有方法：</strong></p>
<ul>
<li>静态分析主要根据常量或I/O关系，大多利用统计特性，可能不准确</li>
<li>动态分析性能不太好</li>
</ul>
<p><strong>缺陷：</strong></p>
<ul>
<li>手动构建签名的准确性</li>
<li>依赖启发式代码片段选择</li>
<li>仅限于已知密码原语</li>
<li>constant state</li>
</ul>
<p><strong>特色</strong></p>
<ul>
<li>
<p>静态分析，基于DFG</p>
<ul>
<li>
<p>表示数据间依赖。便于提取相关操作的子集以生成精确的签名</p>
</li>
<li>
<p>方便重写程序。可以通过重写DFG移除相同算法的不同实例中的变量</p>
</li>
</ul>
</li>
<li>
<p>高效，没有误报（除了签名不够distinctive）</p>
</li>
</ul>
<p><strong>贡献：</strong></p>
<ol>
<li>
<p>高效可靠地自动识别定位对称密码算法以及参数</p>
</li>
<li>
<p>归一化以及签名匹配，可以抵御编译器优化和源码变化</p>
</li>
<li>
<p>知名密码库测试并验证方案有效性</p>
</li>
</ol>
<h2 id="具体方案">具体方案</h2>
<ol>
<li>根据汇编代码构建相应DFG</li>
<li>用重写规则对DFG归一化</li>
<li>在DFG中搜索与密码算法图签名同构的子图</li>
</ol>
<p><img src="dfg.assets/image-20220221181451970.png" alt="image-20220221181451970"></p>
<h4 id="图构建">图构建</h4>
<p>DFG：表示一系列操作之间的数据依赖关系的有向无环图（Directed Acyclic Graph)</p>
<ul>
<li>
<p>顶点：表示算术/逻辑操作或输入变量</p>
</li>
<li>
<p>边：顶点v1到v2的边表示v1(或v1操作后的结果)是v2的输入</p>
</li>
</ul>
<p>根据程序片段F的汇编代码， 将每条指令 i 转换为一组操作 Oi ，而这些操作可能为空（NOP 或分支)，也可能包含多个顶点（可能需要多个操作来重现复杂指令的行为），然后迭代根据F中的指令，构建相应DFG：<code>Gf = (V,E)</code>。其中V是顶点的集合，E是边集</p>
<p>根据输入类型分为以下三种情况：</p>
<ul>
<li>
<p>立即数：向Gf中添加一个常量输入变量。该顶点表示立即数的值，且由边连接到Oi</p>
</li>
<li>
<p>寄存器：在写入该寄存器的最后一个值和 Oi 间创建一个边。实际上，这意味着为每个寄存器维护一个数组，其中包含对 Gf 中该值对应的顶点的引用。</p>
<p>引用：</p>
<ul>
<li>null：寄存器还未被使用（新的输入顶点将被添加到图中）</li>
<li>指向输入变量（寄存器被读取但未被写入）</li>
<li>指向操作（最后被写入寄存器的值）</li>
</ul>
</li>
<li>
<p>内存：load（读取），store（写入）。这两个操作以一个地址作为输入操作数，该地址的计算在Gf中被显式转录。同时还会跟踪程序片段中内存访问的顺序</p>
</li>
</ul>
<h4 id="例子">例子</h4>
<p>custom Even-Mansour cipher</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>C</mi><mo>=</mo><mi>S</mi><mo stretchy="false">(</mo><mi>p</mi><mtext> </mtext><mi>x</mi><mi>o</mi><mi>r</mi><mtext> </mtext><mi>k</mi><mo stretchy="false">)</mo><mtext> </mtext><mi>x</mi><mi>o</mi><mi>r</mi><mtext> </mtext><mi>k</mi></mrow><annotation encoding="application/x-tex">C =S(p\ xor\ k)\ xor\ k
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace"> </span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span><span class="mspace"> </span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace"> </span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span><span class="mspace"> </span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></span></p>
<p>S表示S盒，p表示明文，k表示密钥，C表示密文</p>
<p>其x86汇编代码如下</p>
<p><img src="dfg.assets/image-20220221190220766.png" alt="image-20220221190220766"></p>
<p>其构建的DFG图如下：</p>
<p>矩形框中的表示输入变量，圆框中表示操作</p>
<p><img src="dfg.assets/image-20220221190337262.png" alt="image-20220221190337262"></p>
<h3 id="归一化">归一化</h3>
<p><strong>目的</strong>：在不改变DFG语义的情况下做出调整以便匹配算法子图。即消除开发人员、编译器优化或反汇编导致的不同。</p>
<p>三种规则：</p>
<h4 id="Normalization-Rules">Normalization Rules</h4>
<p>多个指令可以执行相同的操作时使用。</p>
<p><img src="dfg.assets/image-20220221191520450.png" alt="image-20220221191520450"></p>
<h4 id="Memory-Access-Simplification-Rules">Memory Access Simplification Rules</h4>
<p>规范化的图应该不需要任何内存操作，除了那些与输入或输出变量相对应的操作</p>
<ul>
<li>store after store：移除第一个store</li>
<li>load after store：移除load，load的输出与store的输入一样</li>
<li>load after load：合并，两者操作的输出一样</li>
</ul>
<p>但还存在aliasing的问题，当两个不同的顶点等于相同的地址值时，在这种情况下，为两个顶点计算的地址序列是不完整的。这会造成两种后果：</p>
<ul>
<li>
<p>miss additional simplification cases。但这不算真正的问题，因为可以假设这些最后会被其他简化规则处理（如公共子表达式的消除）</p>
</li>
<li>
<p>用不完整的序列进行简化可能不可逆地破坏代码语义，如以下几种情况：</p>
<ol>
<li>两store间有aliased load</li>
<li>store与load间有aliased store</li>
<li>两load间有aliased store</li>
</ol>
<p>解决方法：当检测到一个可能的别名问题时，将内存操作的序列分割开来。其结果是一组序列不存在任何别名矛盾，并且可以安全地进行简化。但缺点在于如果过于inclusive，一些合法的简化案例会被忽略。</p>
</li>
</ul>
<p>比如下图中，load1和load4都是load地址(esp+8)，中间没有写入，即没有aliasing问题，所以可以进行合并</p>
<p><img src="dfg.assets/image-20220222110155634.png" alt="image-20220222110155634"></p>
<h4 id="General-Simplification-Rules">General Simplification Rules</h4>
<p>目的：</p>
<ol>
<li>发现哪些内存访问是在同一地址进行的，以实现前面所述的内存简化</li>
<li>优化未被优化代码的DFG图。由于编译器优化不一定可逆，所以如果需要使未被优化的代码与优化的代码的归一化后的DFG一样，只能优化未被优化的代码。</li>
</ol>
<p>假设下面的指令序列及其优化后的对应序列：</p>
<p><img src="dfg.assets/image-20220222110826232.png" alt="image-20220222110826232"></p>
<p>假设某个编译器刚好执行了这种优化。很明显，这将很难被撤销，而我们无法猜到在序列的最后有一个右移操作。它的规范化表示应该肯定是优化后的结果。因此，每次遇到原始序列时，它都必须被优化。</p>
<p>但由于提出的straight line假设，不需要为配合现代编译器的数据优化做大量工作，只需局部应用于单个基本块（有入口点与出口点）</p>
<p>规则主要分为：</p>
<ul>
<li>
<p>公共子表达式的消除：如果两个操作共享同一组输入操作数，那么它们显然会产生相同的输出。因此，它们中的一个可以安全地从图中删除。</p>
<p>合并由同一组操作数(基数、索引、比例和位移)产生的有效地址。因此，一些内存访问将显式地共享图中的地址顶点。</p>
<p>比如load1和load4地址都是（esp+8)所以可以删掉其中一组操作，两个load共享同一地址顶点。</p>
<p><img src="dfg.assets/image-20220222112450707.png" alt="image-20220222112450707"></p>
</li>
<li>
<p>常数简化</p>
<p>以下两种情况可进行常数简化：</p>
<ol>
<li>如果算术/逻辑运算的每个输入操作数都是一个常变量。操作可以用结果代替</li>
<li>如果一个算术/逻辑运算有一个操作数等于该运算的ientity element或absorbing element(如果它们存在)</li>
</ol>
<p>有时需要重排associative operations的序列。该种规则合并涉及常变量的连续关联运算</p>
<p>如下图中两个加4被化简为加8</p>
<p><img src="dfg.assets/image-20220222113121499.png" alt="image-20220222113121499"></p>
<p>另一种重排策略是distribution，这对于内存地址的简化尤为重要，因为x86寻址模式的比例参数。所以该种规则分配涉及常变量的分配操作</p>
</li>
</ul>
<h3 id="signature-3">signature</h3>
<p>人工构建签名。</p>
<h4 id="macro-signature">macro signature</h4>
<p>目的：针对算法的各种各样实现，有时需要多种签名。为了减少它们的数量，引入宏签名来构建上下文无关的graph grammar。</p>
<p>思想：在每次检测到签名时将一个特殊的顶点附加到DFG。</p>
<p>一个宏签名是一个包含一般的DFG顶点（终端符号）和代表其他签名的顶点（非终端符号符号）的图。</p>
<p>意义：</p>
<ol>
<li>减少需要测试的签名数量。</li>
</ol>
<p>​	没有宏签名时，要测试的签名数量为</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><munderover><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\prod ^n_{i=1}a_i
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∏</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>​	用宏签名，每个备份可以被独立搜索，只需要</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\sum^n_{i=1}a_i
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>个签名</p>
<ol start="2">
<li>将大的图分解成更小的图</li>
</ol>
<h4 id="例子-2">例子</h4>
<p>如果我们要定位密码算法的参数，那么对于明文，密码，密钥，至少一个连接的路径，签名至少都要有一个顶点。</p>
<p>首先创建了一个签名，包含对替换盒的访问（地址计算加内存读取）</p>
<p>然后，右边图中一个新的顶点后(sig1），对应于第一个签名的成功匹配</p>
<p>最后成功匹配custom Even-Mansour算法的签名</p>
<p><img src="dfg.assets/image-20220222141947171.png" alt="image-20220222141947171"></p>
<h3 id="子图同构">子图同构</h3>
<p>给定归一化的DFG与signatures，得到DFG中包含哪些signatures。采用Ullmann子图同构算法</p>
<p>子图定义：如果<code>Va</code>属于<code>Vb</code>且<code>Ea</code>属于<code>Eb</code>，那么<code>Ga = &#123;Va, Ea&#125;</code>是<code>Gb = &#123;Vb, Eb&#125;</code>的子图</p>
<p>同构定义：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>存在函数</mtext><mi>f</mi><mo>:</mo><mi>V</mi><mi>a</mi><mo>↦</mo><mi>V</mi><mi>b</mi><mspace linebreak="newline"></mspace><mtext>使得</mtext><mo stretchy="false">(</mo><mi>v</mi><mo separator="true">,</mo><mi>w</mi><mo stretchy="false">)</mo><mo>∈</mo><mi>E</mi><mi>a</mi><mtext>  </mtext><mo>⟺</mo><mtext>  </mtext><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>f</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>∈</mo><mi>E</mi><mi>b</mi></mrow><annotation encoding="application/x-tex">存在函数f:Va \mapsto Vb
\\使得 (v, w) \in Ea \iff (f(v),f(w)) \in Eb
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord cjk_fallback">存在函数</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6943em;vertical-align:-0.011em;"></span><span class="mord mathnormal">Va</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">↦</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">Vb</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">使得</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7073em;vertical-align:-0.024em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⟺</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord mathnormal">b</span></span></span></span></span></p>
<p>那么<code>Ga = &#123;Va, Ea&#125;</code>与<code>Gb=&#123;Vb, Eb&#125;</code>同构</p>
<p>具体算法如下（深度优先搜索树）：</p>
<ol>
<li>
<p>对签名中的每个顶点v属于Vs，维护一个可能的分配集Av，其被初始化为D中标签与v相同的顶点</p>
</li>
<li>
<p>递归搜索，找到满足条件的f即表示找到了有效的同构子图；否则UPDATE(Av)进行相应剪枝操作，然后继续搜索</p>
</li>
<li>
<p>剪枝：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>v</mi><mo separator="true">,</mo><mi>w</mi><mtext>均属于</mtext><mi>V</mi><mi>s</mi><mtext>，且（</mtext><mi>v</mi><mo separator="true">,</mo><mi>w</mi><mo stretchy="false">)</mo><mo>∈</mo><mi>E</mi><mi>s</mi><mspace linebreak="newline"></mspace><mtext>对所有</mtext><mi>x</mi><mo>∈</mo><mi>A</mi><mi>v</mi><mspace linebreak="newline"></mspace><mtext>不存在</mtext><mi>y</mi><mo>∈</mo><mi>A</mi><mi>w</mi><mo separator="true">,</mo><mtext> 使得</mtext><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>∈</mo><mi>E</mi><mi>d</mi><mspace linebreak="newline"></mspace><mtext>那么可以从</mtext><mi>A</mi><mi>v</mi><mtext>中删除</mtext><mi>x</mi></mrow><annotation encoding="application/x-tex">v,w均属于Vs，且（v,w)\in Es
\\对所有x \in Av
\\不存在y\in Aw,\ 使得(x,y)\in Ed
\\那么可以从Av中删除x
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord cjk_fallback">均属于</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mord mathnormal">s</span><span class="mord cjk_fallback">，且（</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord mathnormal">s</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord cjk_fallback">对所有</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord cjk_fallback">不存在</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mspace"> </span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord cjk_fallback">使得</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord mathnormal">d</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">那么可以从</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord cjk_fallback">中删除</span><span class="mord mathnormal">x</span></span></span></span></span></p>
</li>
</ol>
<p><img src="dfg.assets/image-20220222143759387.png" alt="image-20220222143759387"></p>
<h2 id="测试评估">测试评估</h2>
<p>为什么该方法没有误报：</p>
<ol>
<li>归一化过程保留语义。</li>
<li>Ullmann算法得到是精准的。虽然也可能签名不够distingctive，其他算法的DFG也可能匹配该签名。</li>
</ol>
<h4 id="XTEA">XTEA</h4>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="http://en.wikipedia.org/w/index.php?title=XTEA&amp;oldid=618892433">http://en.wikipedia.org/w/index.php?title=XTEA&amp;oldid=618892433</a> 的c语言实现</p>
<p><img src="dfg.assets/image-20220222152208862.png" alt="image-20220222152208862"></p>
<p>Crypto++, LibTomCrypt, Botan，均成功检测。但存在密钥调度问题，LibTomCrypt中在早期初始化阶段进行得到round key buffer；Crypto++或Botan则在主要的加解密循环中计算。而这种差异不能通过归一化消除，所以应在签名级别处理。因此去掉签名中的密钥调度来得到对不同版本保持一致性的签名。虽然密钥无法识别，但是round key buffer和密钥调度的最终操作是作为签名输入变量的一部分被识别的</p>
<h4 id="MD5">MD5</h4>
<p>RFC中的C语言实现</p>
<p><img src="dfg.assets/image-20220222152902061.png" alt="image-20220222152902061"></p>
<p>除MSVC外，代表Feistel网络的final macro signature的识别是成功的。</p>
<p>在MSVC的情况下，并不是所有的64轮签名都能正确检测到第二个信息块的。因此取决于每个回合的正确识别最后的签名在第二个消息块中没有被检测到。该问题可以用以下两点来解释：</p>
<ol>
<li>Rotation：每轮函数都包括循环移位。由于C中没有循环移位运算符，需要用两个移位和一个or运算符来实现。有些编译器能识别并转换为x86中的循环移位指令。但MSVC并不总是进行这样的转换，但确定重写规则来识别并将其转换为一个循环移位的顶点是非常困难的。所以在签名层面解决该问题，同时说明macro signature的好处（64轮的总组合数是2^64，而用macro signatures只需要轮签名数量的两倍）</li>
<li>constant state：第一个信息块的状态被常量初始化。由于之前涉及初始状态的操作与周围的操作合并以使数字简化的重写规则，MSVC中第二个信息块的开始若有扩展形式的循环移位指令，将会影响预期的签名模式。该问题尚未被解决，希望能有消除分布在几个顶点上的公共子表达式的方法。</li>
</ol>
<p>Crypto++, LibTomCrypt and OpenSSL中md5的测试均成功，因为循环移位都是用x86指令集实现的，且初始状态未被视为常量，因为API设计初始化在代码片段之外的另一个函数中执行。</p>
<h4 id="AES">AES</h4>
<p>Gladman网站提供的源代码</p>
<p><img src="dfg.assets/image-20220222195328619.png" alt="image-20220222195328619"></p>
<p>Crypto++,LibTomCrypt and Botan</p>
<p>Crypto++只能检测解密的算法，加密由于其使用MMX和SSE2指令（DFG构建时不支持）未被成功识别。其余均成功检测</p>
<h4 id="性能">性能</h4>
<p>子图同构是NP完全问题，但大多数情况都可以有校解决</p>
<p>每一列对应一个代码片段（来源于LibTomCrypt），每一行对应一个签名</p>
<ul>
<li>
<p>灰色表示未成功匹配，能很快出结果（&lt;1ms)</p>
</li>
<li>
<p>大的签名（涵盖几个回合的签名）所花费的时间的时间明显多于较小的签名（仅覆盖一个回合)。因此可以用macro signature来减少签名的大小。但顶点的数量并不是影响执行时间的唯一参数，有时较大的签名意味着其顶点之间有更强的结构约束，子图同构算法就能更快地收敛到解决方案</p>
</li>
<li>
<p>每条重写规则都是与顶点数量成线性关系的，除了普通的子表达规则是二次的（至少对naive implementation)。然而，如前所述，重写规则规则是迭代应用的，直到达到一个平衡点。因此，执行时间也取决于原始DFG与归一化DFG之间的距离。在实践中归一化的执行时间并不超过签名匹配的执行时间</p>
</li>
</ul>
<p><img src="dfg.assets/image-20220222195734989.png" alt="image-20220222195734989"></p>
<h2 id="改进">改进</h2>
<ul>
<li>通过利用macro signature，涵盖块密码的操作模式</li>
<li>自动识别公钥密码算法</li>
<li>从参考实现中自动生成签名</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined" rel="external nofollow noreferrer">Scorpion</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://scorpionre.github.io/2022/02/22/dfg/">https://scorpionre.github.io/2022/02/22/dfg/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener external nofollow noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/crypto/">crypto</a><a class="post-meta__tags" href="/tags/CryptoDetect/">CryptoDetect</a><a class="post-meta__tags" href="/tags/reverse/">reverse</a><a class="post-meta__tags" href="/tags/paper/">paper</a></div><div class="post_share"><div class="social-share" data-image="https://scorpionre.github.io/2022/02/22/dfg/dfg.assets/image-20220218195458486.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/01/28/md5/"><img class="prev-cover" src="https://scorpionre.github.io/2022/01/28/md5/md5.assets/image-20220127171124399.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">MD5</div></div></a></div><div class="next-post pull-right"><a href="/2022/02/23/sha1/"><img class="next-cover" src="/image/star.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">SHA1</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2021/12/03/aligot/" title="[论文笔记-ccs12]Aligot"><img class="cover" src="https://scorpionre.github.io/2021/12/03/aligot/aligot.assets/image-20211128145601514.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-12-03</div><div class="title">[论文笔记-ccs12]Aligot</div></div></a></div><div><a href="/2021/06/25/where-s-crypto/" title="[论文笔记-usenix2021]where's-crypto"><img class="cover" src="https://scorpionre.github.io/2021/06/25/where-s-crypto/where-s-crypto.assets/image-20210601155403815.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-06-25</div><div class="title">[论文笔记-usenix2021]where's-crypto</div></div></a></div><div><a href="/2022/02/24/lfsr/" title="LFSR"><img class="cover" src="https://scorpionre.github.io/2022/02/24/lfsr/lfsr.assets/image-20220224160744696.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-24</div><div class="title">LFSR</div></div></a></div><div><a href="/2022/01/23/AES/" title="AES"><img class="cover" src="https://scorpionre.github.io/2022/01/23/AES/AES.assets/aes_details.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-01-23</div><div class="title">AES</div></div></a></div><div><a href="/2022/01/14/DES/" title="DES"><img class="cover" src="https://scorpionre.github.io/2022/01/14/DES/DES.assets/image-20220112114938574.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-01-14</div><div class="title">DES</div></div></a></div><div><a href="/2022/01/28/md5/" title="MD5"><img class="cover" src="https://scorpionre.github.io/2022/01/28/md5/md5.assets/image-20220127171124399.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-01-28</div><div class="title">MD5</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">DFG论文</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%83%8C%E6%99%AF"><span class="toc-text">背景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B7%E4%BD%93%E6%96%B9%E6%A1%88"><span class="toc-text">具体方案</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9B%BE%E6%9E%84%E5%BB%BA"><span class="toc-text">图构建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90"><span class="toc-text">例子</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BD%92%E4%B8%80%E5%8C%96"><span class="toc-text">归一化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Normalization-Rules"><span class="toc-text">Normalization Rules</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Memory-Access-Simplification-Rules"><span class="toc-text">Memory Access Simplification Rules</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#General-Simplification-Rules"><span class="toc-text">General Simplification Rules</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#signature-3"><span class="toc-text">signature</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#macro-signature"><span class="toc-text">macro signature</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90-2"><span class="toc-text">例子</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%90%E5%9B%BE%E5%90%8C%E6%9E%84"><span class="toc-text">子图同构</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E8%AF%84%E4%BC%B0"><span class="toc-text">测试评估</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#XTEA"><span class="toc-text">XTEA</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#MD5"><span class="toc-text">MD5</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#AES"><span class="toc-text">AES</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%A7%E8%83%BD"><span class="toc-text">性能</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%94%B9%E8%BF%9B"><span class="toc-text">改进</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url('https://scorpionre.github.io/2022/02/22/dfg/dfg.assets/image-20220218195458486.png')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By Scorpion</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="Switch Between Traditional Chinese And Simplified Chinese">简</button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Local search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.css"><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>